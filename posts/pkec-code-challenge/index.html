<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8" /><meta content="width=device-width, initial-scale=1.0" name="viewport" /><title>PKCEのcode_challenge生成 - rono23</title><link rel="alternate" type="application/atom+xml" title="rono23 - Atom Feed" href="/posts/feed.xml" /><link href="/stylesheets/all-02e42f4d.css" rel="stylesheet" /><script src="/javascripts/all-da39a3ee.js"></script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-845284-7', 'auto');
  ga('send', 'pageview');
</script>
</head><body><div class="header clear"><div class="l-constrained"><h1><a href="/">rono23</a></h1><ul><li><a href="/about">About</a></li></ul></div></div><div class="hero" style="background-image: url('/images/hero/default-71bf53ff.jpg')"></div><div class="main"><div class="l-constrained"><div class="post-date">January 15, 2021</div><div class="post-title">PKCEのcode_challenge生成</div><div class="markdown"><blockquote>
<p>code_verifier=dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk<br>
code_challenge=E9Melhoa2OwvFrEMTJguCHaoeK1t8URWbuGJSstw-cM<br>
<a href="https://tools.ietf.org/html/rfc7636">https://tools.ietf.org/html/rfc7636</a></p>
</blockquote>

<p>Swift</p>

<pre><code>import CryptoKit

let codeVerifier = &quot;dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk&quot;
let data = Data(codeVerifier.utf8)
let hash = SHA256.hash(data: data)
let codeChallenge = Data(hash).base64EncodedString()
    .replacingOccurrences(of: &quot;=&quot;, with: &quot;&quot;)
    .replacingOccurrences(of: &quot;+&quot;, with: &quot;-&quot;)
    .replacingOccurrences(of: &quot;/&quot;, with: &quot;_&quot;)
</code></pre>

<p>Ruby</p>

<pre><code>require &#39;base64&#39;
require &#39;openssl&#39;

code_verifier = &quot;dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk&quot;
code_challenge = Base64.urlsafe_encode64(OpenSSL::Digest::SHA256.digest(code_verifier), padding: false)
</code></pre>

<hr>

<p>最初、<a href="https://www.hackingwithswift.com/example-code/cryptokit/how-to-calculate-the-sha-hash-of-a-string-or-data-instance">ハッシュ値を文字列</a>で扱って少しハマったけど <code>CommonCrypto</code> を使わずにできてよかった 🎉</p>
</div><div class="post-comment"><p><a href="https://github.com/rono23/rono23.github.io/issues/new?title=[pkec-code-challenge]%20">Post a comment on GitHub</a></p></div><div class="post-tags"><ul class="inline"><li>Tags:</li><li><a href="/posts/tags/ios/">ios</a></li><li><a href="/posts/tags/ruby/">ruby</a></li></ul></div></div></div><div class="footer"><div class="l-constrained"><div class="copy">&copy; 2021 rono23</div></div></div></body></html>